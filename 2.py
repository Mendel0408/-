import os
import arcpy
import pyproj
import numpy as np

# img = '1'
# img = '5'
# img = '6'
# img = '7'
# img = '13'
# img = '15'
# img = '16'
# img = '17'
# img = '0539'
# img = '0518'
# img = 'Henn'
img = 'Broyn'
# img = 'Tirion'


# CALC Area 计算面积


if img == '1':
    pixel_add_name = '1'
    img_name = '1.jpg'
    pred_img_name = '1_pred.jpg'
    # 定义矩阵 M 和相机位置
    M = np.array([[7.15498794e-07, -4.64869286e-07, -6.48150799e-02], \
                  [1.08837039e-05, 8.70721920e-07, -5.35814500e-02], \
                  [3.38892198e-07, -8.41645601e-06, 7.10846985e-03]])
    camera_location = [222865.06494141, 631681.68554688, 744.]

    H = np.array([[-7.82712550e+04, 9.65803372e+04, 1.43148754e+04], \
                  [-1.68103500e+04, 4.76047970e+03, -1.17393868e+05], \
                  [-1.61719831e+01, 1.03201468e+00, 1.00000000e+00]])
    y_segment_move = 0

elif img == '5':
    pixel_add_name = '5'
    img_name = '5.jpg'
    pred_img_name = '5_pred_fix.jpg'
    H = np.array([[-4.25818087e+03, 7.20579658e+03, -2.04124112e+03], \
                  [-1.21156665e+02, 2.93139642e+02, -3.58402358e+03], \
                  [-7.77778380e-01, 1.11701509e-01, 1.00000000e+00]])
    camera_location = [223237.64147949, 631881.32067871, 826.]

    M = np.array([[3.94718298e-05, -4.23120684e-04, -1.43590299e+00], \
                  [1.65560539e-04, -3.32734639e-04, -8.54579811e-01], \
                  [1.22069738e-05, -2.91927159e-04, -2.13564451e-02]]
                 )
    y_segment_move = 0

if img == '6':
    pixel_add_name = '6'
    img_name = '6.jpg'
    pred_img_name = '6_pred2.jpg'
    M = np.array([[-1.20929046e-06, -6.54714498e-07, -5.56540780e-03], \
                  [1.92526983e-06, 1.00228650e-06, -1.01312992e-02], \
                  [1.10425431e-07, -2.05034240e-06, 1.80732602e-04]]
                 )
    camera_location = [223163.1262207, 631943.70654297, 798.]

    H = np.array([[-4.25034958e+05, 2.37980099e+05, 2.52055847e+05], \
                  [-3.02748382e+04, 8.17404278e+03, -4.74060280e+05], \
                  [-8.37652731e+01, -5.26715629e+01, 1.00000000e+00]], \
                 )
    y_segment_move = 0


elif img == '7':
    pixel_add_name = '7'
    img_name = '7.jpg'
    pred_img_name = '7_pred.jpg'
    M = np.array([[-4.44240296e-05, -1.04746034e-04, -7.13035183e-01], \
                  [7.21854641e-05, -7.53794690e-05, -8.52081852e-01], \
                  [5.90177628e-07, -1.21308702e-04, 4.86781294e-03]]
                 )
    camera_location = [223250.06066895, 632205.72753906, 831.]

    H = np.array([[-9.50813662e+03, 7.97514621e+03, 3.25431984e+03], \
                  [-7.83025276e+01, 1.87509882e+01, -8.18747164e+03], \
                  [-7.98569820e-01, -4.99627833e-01, 1.00000000e+00]]
                 )
    y_segment_move = 0

elif img == '13':
    pixel_add_name = '13'
    img_name = '13.jpg'
    pred_img_name = '13_pred_fix.jpg'
    M = np.array([[5.46861899e-04, -6.16629502e-03, -5.55191089e+00], \
                  [8.17388723e-04, 4.96682571e-03, -6.50108162e-01], \
                  [2.43038016e-05, -9.28859115e-04, 4.00160189e-01]]
                 )
    camera_location = [223336.99523926, 631095.25756836, 731.]

    H = np.array([[1.78389726e+02, 9.82984573e+02, 4.07199467e+03], \
                  [-4.42067582e+01, 4.56092563e+01, -5.39236631e+02], \
                  [-1.13448064e-01, 4.61672899e-02, 1.00000000e+00]]
                 )
    y_segment_move = 0

elif img == '15':
    pixel_add_name = '15'
    img_name = '15.jpg'
    pred_img_name = '15_pred.jpg'
    M = np.array([[-5.51377242e-05, -9.08371411e-04, 3.11593472e+00], \
                  [-4.57974762e-04, -8.42501632e-05, 4.28606726e-01], \
                  [4.81189606e-07, 3.54018054e-04, -2.07891754e-01]])
    camera_location = [222989.25708008, 631569.39086914, 768.]

    H = np.array([[3.26277972e+02, -2.22248466e+03, 3.08280567e+02], \
                  [2.30945138e+02, -2.42201038e+01, 3.41153057e+03], \
                  [3.94030779e-01, -4.63885187e-02, 1.00000000e+00]])
    y_segment_move = 0

elif img == '16':
    pixel_add_name = '16'
    img_name = '16.jpg'
    pred_img_name = '16_pred.jpg'
    M = np.array([[-1.13640481e-03, -6.16246577e-03, -3.22065044e+00],
                  [1.70825388e-03, -2.94207061e-03, -4.08683562e+00],
                  [2.75099149e-05, -1.17627612e-03, 1.08416584e-01]])
    camera_location = [223374.25292969, 631981.13818359, 830.]

    H = np.array([[-3.69578520e+02, 3.21293913e+02, 1.13259597e+03],
                  [-2.14579758e+01, -2.49489631e+00, -7.31482838e+02],
                  [-1.39032521e-01, -1.08594597e-01, 1.00000000e+00]])
    y_segment_move = 0


elif img == '17':
    pixel_add_name = '17'
    img_name = '17.jpg'
    pred_img_name = '17_pred.jpg'
    M = np.array([[-5.58428771e-06, -1.02955632e-03, -2.38875451e+00],
                  [3.32940290e-04, -1.01660362e-03, -1.48402231e+00],
                  [1.61749493e-05, -4.44294911e-04, 1.71858136e-02]])
    camera_location = [223324.57592773, 631981.13818359, 824.]

    H = np.array([[-1.94231482e+03, 3.09651636e+03, -2.58433582e+03],
                  [-8.53068481e+01, 1.10607408e+02, -2.30616120e+03],
                  [-3.77320210e-01, -5.49107886e-02, 1.00000000e+00]])
    y_segment_move = 0


elif img == '0539':
    pixel_add_name = 'DSC_0539'
    img_name = 'DSC_0539.jpg'
    pred_img_name = 'DSC_0539_pred.jpg'
    M = np.array([[-2.05304827e-04, -1.59569478e-03, 5.49866264e+00], \
                  [-9.75827424e-04, 6.69029954e-04, 5.24208012e-01], \
                  [-2.34321436e-05, 7.32681239e-04, -1.21113929e+00]])
    camera_location = [222914.74169922, 631581.86804199, 754.]

    H = np.array([[7.04857765e+02, -1.23705268e+03, 2.66468288e+03], \
                  [7.04728174e+02, -2.22781434e+02, 3.10309368e+03], \
                  [4.12689761e-01, -1.10838598e-01, 1.00000000e+00]])
    y_segment_move = 30


elif img == '0518':
    pixel_add_name = 'DSC_0518'
    img_name = 'DSC_0518.jpg'
    pred_img_name = 'DSC_0518_pred.jpg'
    H = np.array([[9.87192865e-08, 9.76622075e-11, -1.03498278e-03],
                  [3.32745926e-07, 1.06050336e-09, -5.84907922e-04],
                  [3.99142036e-09, -2.51736974e-07, 4.46469418e-04]])
    camera_location = [222914.74169922, 631581.86804199, 754.]

    M = np.array([[-2.03294671e+06, 3.60825913e+06, 1.44119825e+04],
                  [-2.09009749e+06, 6.67718049e+05, -3.97039811e+06],
                  [-1.16030449e+03, 3.44227927e+02, 1.00000000e+00]])
    y_segment_move = 0


elif img == 'Henn':
    pixel_add_name = 'Henniker'
    img_name = 'NNL_Henniker.jpg'
    pred_img_name = 'Hen_pred.jpg'
    M = np.array([[-4.74584864e-04, -6.94555777e-03, 7.35875242e+00], \
                  [-2.96901000e-03, -2.67471987e-03, 1.74795249e+00], \
                  [-7.20293404e-05, 1.32927328e-03, -4.71823085e-01]]
                 )
    camera_location = [223386.67211914, 631107.73474121, 737.]

    H = np.array([[5.48526910e+01, -3.36125571e+02, -3.89731152e+02], \
                  [7.88935234e+01, -3.89605350e+01, 1.08612054e+03], \
                  [2.13893836e-01, -5.84504995e-02, 1.00000000e+00]]
                 )
    y_segment_move = 0



elif img == 'Broyn':
    pixel_add_name = 'Broyin'
    img_name = 'de-broyn-1698.tif'
    pred_img_name = 'de_broyn_pred.jpg'
    M = np.array([[-3.27576753e-04, -3.19880551e-03, 2.36687370e+00],
                  [-1.79249870e-03, -2.64373329e-03, 5.47862297e-01],
                  [-1.23896006e-04, 1.25140985e-03, -1.59203311e-01]])
    camera_location = [223361.83361816, 631095.25756836, 733.]

    H = np.array([[5.43793083e+01, -5.03852656e+02, -9.25438781e+02],
                  [7.25682165e+01, -7.09551409e+01, 8.34694677e+02],
                  [5.28099580e-01, -1.65628657e-01, 1.00000000e+00]])
    y_segment_move = 0


elif img == 'Tirion':
    pixel_add_name = 'Tirion'
    img_name = 'Tirion-1732.tif'
    pred_img_name = 'Tirion_1732_pred.jpg'
    M = np.array([[-5.89253561e-04, -2.46831760e-03, 2.57277103e+00],
                  [-2.06503407e-03, -2.21043230e-03, 9.35079518e-01],
                  [-6.94464825e-05, 1.13100581e-03, -4.81120873e-01]])
    camera_location = [223374.25292969, 631095.25756836, 733.]

    H = np.array([[-1.55606997e+00, -4.53864695e+02, -8.90426951e+02], \
                  [2.78936827e+02, -1.21795553e+02, 1.25488644e+03], \
                  [6.55941684e-01, -2.20801420e-01, 1.00000000e+00]])
    y_segment_move = 0